[gd_scene load_steps=28 format=3 uid="uid://bmxwr384pvyx6"]

[ext_resource type="Script" path="res://resources/source/combat_phase/combat_managers/UnitSelectionManager.cs" id="1_fha01"]
[ext_resource type="PackedScene" uid="uid://da8axfdvo5q6w" path="res://resources/prefabs/menus/reward_selection_ui.tscn" id="1_ivmmf"]
[ext_resource type="Script" path="res://resources/source/combat_phase/combat_managers/CSHeadManager.cs" id="1_jmkeh"]
[ext_resource type="Script" path="res://resources/source/combat_phase/combat_ui/DefeatUI.cs" id="1_sreor"]
[ext_resource type="Script" path="res://resources/source/combat_phase/combat_managers/SceneManager.cs" id="2_6f53p"]
[ext_resource type="Script" path="res://resources/source/ui/EnterButton.cs" id="2_u33td"]
[ext_resource type="PackedScene" uid="uid://baue8h1kkk2fp" path="res://resources/prefabs/combat_level/UI/combat_ui.tscn" id="3_31aox"]
[ext_resource type="Script" path="res://resources/source/combat_phase/combat_managers/ActionManager.cs" id="3_l2ig0"]
[ext_resource type="Script" path="res://resources/source/ui/ExitButton.cs" id="3_mvp3o"]
[ext_resource type="Script" path="res://resources/source/combat_phase/combat_managers/TurnManager.cs" id="4_smpwj"]
[ext_resource type="Texture2D" uid="uid://c3p3tgx1gndqq" path="res://resources/sprites/floor.png" id="8_k3urn"]
[ext_resource type="Texture2D" uid="uid://d0hy8frpb5o8s" path="res://resources/sprites/office.png" id="10_1bc4p"]
[ext_resource type="Texture2D" uid="uid://bhwyr1hx6i50e" path="res://resources/sprites/testing_area.png" id="12_svx23"]

[sub_resource type="Animation" id="Animation_hcixt"]
length = 0.001
tracks/0/type = "value"
tracks/0/imported = false
tracks/0/enabled = true
tracks/0/path = NodePath(".:modulate")
tracks/0/interp = 1
tracks/0/loop_wrap = true
tracks/0/keys = {
"times": PackedFloat32Array(0),
"transitions": PackedFloat32Array(1),
"update": 0,
"values": [Color(1, 1, 1, 0)]
}

[sub_resource type="Animation" id="Animation_nk6xy"]
resource_name = "defeat_ui_appear"
tracks/0/type = "value"
tracks/0/imported = false
tracks/0/enabled = true
tracks/0/path = NodePath(".:modulate")
tracks/0/interp = 1
tracks/0/loop_wrap = true
tracks/0/keys = {
"times": PackedFloat32Array(0, 1),
"transitions": PackedFloat32Array(1, 1),
"update": 0,
"values": [Color(1, 1, 1, 0), Color(1, 1, 1, 1)]
}

[sub_resource type="AnimationLibrary" id="AnimationLibrary_i53ig"]
_data = {
"RESET": SubResource("Animation_hcixt"),
"defeat_ui_appear": SubResource("Animation_nk6xy")
}

[sub_resource type="StandardMaterial3D" id="StandardMaterial3D_e6fry"]
albedo_color = Color(0.54902, 0.207843, 0.52549, 1)

[sub_resource type="ORMMaterial3D" id="ORMMaterial3D_rn54r"]
albedo_color = Color(0.639216, 0.25098, 0.588235, 1)

[sub_resource type="StandardMaterial3D" id="StandardMaterial3D_1bqpu"]
albedo_color = Color(0.486275, 0.176471, 0.47451, 1)

[sub_resource type="StandardMaterial3D" id="StandardMaterial3D_lk6v8"]
albedo_color = Color(0.486275, 0.176471, 0.47451, 1)

[sub_resource type="StandardMaterial3D" id="StandardMaterial3D_ghjn4"]
albedo_color = Color(0.505882, 0.223529, 0.556863, 1)

[sub_resource type="StandardMaterial3D" id="StandardMaterial3D_x2hv1"]
albedo_color = Color(0.696947, 0.348626, 0.77562, 1)
metallic = 1.0
metallic_specular = 1.0

[sub_resource type="BoxShape3D" id="BoxShape3D_crgnk"]
size = Vector3(100, 100, 0.111328)

[sub_resource type="StandardMaterial3D" id="StandardMaterial3D_qckc2"]
albedo_texture = ExtResource("8_k3urn")
uv1_scale = Vector3(1, 0.595, 1)
uv1_offset = Vector3(0, 1.03, 0)
texture_filter = 0

[sub_resource type="PanoramaSkyMaterial" id="PanoramaSkyMaterial_1aplc"]
panorama = ExtResource("12_svx23")

[sub_resource type="Sky" id="Sky_8htjt"]
sky_material = SubResource("PanoramaSkyMaterial_1aplc")

[sub_resource type="Environment" id="Environment_h48l1"]
background_mode = 2
background_energy_multiplier = 4.25
sky = SubResource("Sky_8htjt")
sky_rotation = Vector3(0.0453786, -2.18166, 0.401426)
ambient_light_sky_contribution = 0.0
glow_enabled = true
glow_intensity = 7.45
fog_light_energy = 1.5
volumetric_fog_density = 0.0

[node name="level_placeholder" type="Node3D"]

[node name="defeat_ui" type="Control" parent="."]
modulate = Color(1, 1, 1, 0)
layout_mode = 3
anchors_preset = 15
anchor_right = 1.0
anchor_bottom = 1.0
grow_horizontal = 2
grow_vertical = 2
script = ExtResource("1_sreor")

[node name="ColorRect" type="ColorRect" parent="defeat_ui"]
layout_mode = 1
anchors_preset = 15
anchor_right = 1.0
anchor_bottom = 1.0
grow_horizontal = 2
grow_vertical = 2
color = Color(0, 0, 0, 1)

[node name="MarginContainer" type="MarginContainer" parent="defeat_ui"]
layout_mode = 1
anchors_preset = 15
anchor_right = 1.0
anchor_bottom = 1.0
grow_horizontal = 2
grow_vertical = 2

[node name="VBoxContainer" type="VBoxContainer" parent="defeat_ui/MarginContainer"]
layout_mode = 2

[node name="MarginContainer" type="MarginContainer" parent="defeat_ui/MarginContainer/VBoxContainer"]
layout_mode = 2
theme_override_constants/margin_top = 170

[node name="RichTextLabel" type="RichTextLabel" parent="defeat_ui/MarginContainer/VBoxContainer/MarginContainer"]
custom_minimum_size = Vector2(400, 100)
layout_mode = 2
size_flags_horizontal = 4
theme_override_colors/default_color = Color(0.999812, 0.213113, 0.160068, 1)
theme_override_font_sizes/normal_font_size = 51
bbcode_enabled = true
text = "[center]DEFEAT[center]"

[node name="MarginContainer" type="MarginContainer" parent="defeat_ui/MarginContainer/VBoxContainer/MarginContainer"]
layout_mode = 2
theme_override_constants/margin_top = 155

[node name="menu_buttons_container" type="MarginContainer" parent="defeat_ui/MarginContainer/VBoxContainer/MarginContainer/MarginContainer"]
layout_mode = 2
size_flags_horizontal = 4
size_flags_vertical = 8
theme_override_constants/margin_bottom = 60

[node name="VBoxContainer" type="VBoxContainer" parent="defeat_ui/MarginContainer/VBoxContainer/MarginContainer/MarginContainer/menu_buttons_container"]
layout_mode = 2
size_flags_horizontal = 4
size_flags_vertical = 4

[node name="try_again_button" type="RichTextLabel" parent="defeat_ui/MarginContainer/VBoxContainer/MarginContainer/MarginContainer/menu_buttons_container/VBoxContainer"]
custom_minimum_size = Vector2(200, 30)
layout_mode = 2
size_flags_horizontal = 4
size_flags_vertical = 4
theme_override_font_sizes/normal_font_size = 30
bbcode_enabled = true
text = "[center]Try Again[center]"
fit_content = true
script = ExtResource("2_u33td")

[node name="separator" type="Control" parent="defeat_ui/MarginContainer/VBoxContainer/MarginContainer/MarginContainer/menu_buttons_container/VBoxContainer"]
custom_minimum_size = Vector2(0, 23.44)
layout_mode = 2

[node name="exit_button" type="RichTextLabel" parent="defeat_ui/MarginContainer/VBoxContainer/MarginContainer/MarginContainer/menu_buttons_container/VBoxContainer"]
custom_minimum_size = Vector2(100, 20)
layout_mode = 2
size_flags_horizontal = 4
size_flags_vertical = 4
theme_override_font_sizes/normal_font_size = 25
bbcode_enabled = true
text = "[center]Exit[center]"
fit_content = true
script = ExtResource("3_mvp3o")

[node name="animation_player" type="AnimationPlayer" parent="defeat_ui"]
libraries = {
"": SubResource("AnimationLibrary_i53ig")
}

[node name="reward_selection_ui" parent="." instance=ExtResource("1_ivmmf")]

[node name="managers" type="Node3D" parent="."]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, -0.0210505, 0, -0.0001297)
script = ExtResource("1_jmkeh")

[node name="scene_manager" type="Node3D" parent="managers"]
script = ExtResource("2_6f53p")

[node name="combat_ui_manager" parent="managers" instance=ExtResource("3_31aox")]

[node name="unit_selection_manager" type="Node3D" parent="managers"]
script = ExtResource("1_fha01")

[node name="action_manager" type="Node3D" parent="managers"]
script = ExtResource("3_l2ig0")

[node name="turn_manager" type="Node3D" parent="managers"]
script = ExtResource("4_smpwj")

[node name="light_source" type="DirectionalLight3D" parent="."]
transform = Transform3D(1, 0, 0, 0, 0.978509, 0.206204, 0, -0.206204, 0.978509, 0, 0.641662, 0)
visible = false

[node name="Node3D2" type="Node3D" parent="."]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 0, -0.495, -0.32)

[node name="CSGBox3D" type="CSGBox3D" parent="Node3D2"]
transform = Transform3D(0.900121, 0.43564, 0, -0.42098, 0.869831, -0.257234, -0.112061, 0.231542, 0.966349, 0, 1.96105, -4.90723)
material_override = SubResource("StandardMaterial3D_e6fry")

[node name="CSGBox3D2" type="CSGBox3D" parent="Node3D2"]
transform = Transform3D(0.900121, 0.43564, 4.66309e-10, -0.265695, 0.54898, 0.792481, 0.345236, -0.713329, 0.609896, 5.12244, 4.01544, -5.54307)
material_override = SubResource("ORMMaterial3D_rn54r")

[node name="CSGBox3D3" type="CSGBox3D" parent="Node3D2"]
transform = Transform3D(0.355513, -0.0419312, 0.933731, 0.426656, -0.881559, -0.202035, 0.83161, 0.470208, -0.295515, -7.81438, 5.02215, -11.1941)
material_override = SubResource("StandardMaterial3D_1bqpu")

[node name="CSGBox3D4" type="CSGBox3D" parent="Node3D2"]
transform = Transform3D(0.355513, -0.0419312, 0.933731, 0.426656, -0.881559, -0.202035, 0.83161, 0.470208, -0.295515, -11.5433, 11.3872, -15.6923)
material_override = SubResource("StandardMaterial3D_lk6v8")

[node name="CSGBox3D5" type="CSGBox3D" parent="Node3D2"]
transform = Transform3D(0.355513, -0.0419312, 0.933731, 0.426656, -0.881559, -0.202035, 0.83161, 0.470208, -0.295515, 6.29565, 10.5899, -11.6404)
material_override = SubResource("StandardMaterial3D_ghjn4")

[node name="CSGBox3D6" type="CSGBox3D" parent="Node3D2"]
transform = Transform3D(0.355513, -0.0419312, 0.933731, 0.426656, -0.881559, -0.202035, 0.83161, 0.470208, -0.295515, 6.20335, 15.9877, -15.6224)
material_override = SubResource("StandardMaterial3D_x2hv1")

[node name="background_mouse_collider" type="StaticBody3D" parent="."]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0, 0.792978)
collision_layer = 2
collision_mask = 2

[node name="CollisionShape3D" type="CollisionShape3D" parent="background_mouse_collider"]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0, -0.5)
shape = SubResource("BoxShape3D_crgnk")

[node name="ground" type="Node3D" parent="."]

[node name="ground_placeholder" type="CSGBox3D" parent="ground"]
transform = Transform3D(-4.37114e-08, 0, -1, 0, 1, 0, 1, 0, -4.37114e-08, 0, -0.495, -0.32)
visible = false
material_override = SubResource("StandardMaterial3D_qckc2")
size = Vector3(20, 1, 20)

[node name="ground_placeholder2" type="CSGBox3D" parent="ground"]
transform = Transform3D(-1.76521e-08, 0, -1, 0, 1, 0, 0.403833, 0, -4.37114e-08, -1.13356e-07, -0.495, 2.27329)
material_override = SubResource("StandardMaterial3D_qckc2")
size = Vector3(20, 1, 20)

[node name="ground_placeholder3" type="CSGBox3D" parent="ground"]
transform = Transform3D(-1.76521e-08, 0, -1, 0, 1, 0, 0.403833, 0, -4.37114e-08, -19.9645, -0.495, 2.27329)
material_override = SubResource("StandardMaterial3D_qckc2")
size = Vector3(20, 1, 20)

[node name="ground_placeholder4" type="CSGBox3D" parent="ground"]
transform = Transform3D(-1.76521e-08, 0, -1, 0, 1, 0, 0.403833, 0, -4.37114e-08, 19.987, -0.495, 2.27329)
material_override = SubResource("StandardMaterial3D_qckc2")
size = Vector3(20, 1, 20)

[node name="WorldEnvironment" type="WorldEnvironment" parent="."]
environment = SubResource("Environment_h48l1")

[node name="Sprite3D" type="Sprite3D" parent="."]
transform = Transform3D(2.44524, 0, 0, 0, 1.5302, 0, 0, 0, 1, 0, 7.56941, -2.3098)
visible = false
texture = ExtResource("10_1bc4p")

[node name="OmniLight3D" type="OmniLight3D" parent="."]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, -1.00864, 6.25787, 2.05031)
light_color = Color(0.748233, 0.70041, 0.642989, 1)
light_energy = 13.053
omni_range = 13.555

[node name="OmniLight3D2" type="OmniLight3D" parent="."]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 1.48322, 11.995, -14.8693)
light_color = Color(0.748233, 0.70041, 0.642989, 1)
light_energy = 20.008
omni_range = 24.355

[connection signal="mouse_entered" from="defeat_ui/MarginContainer/VBoxContainer/MarginContainer/MarginContainer/menu_buttons_container/VBoxContainer/try_again_button" to="defeat_ui/MarginContainer/VBoxContainer/MarginContainer/MarginContainer/menu_buttons_container/VBoxContainer/try_again_button" method="_on_mouse_entered"]
[connection signal="mouse_exited" from="defeat_ui/MarginContainer/VBoxContainer/MarginContainer/MarginContainer/menu_buttons_container/VBoxContainer/try_again_button" to="defeat_ui/MarginContainer/VBoxContainer/MarginContainer/MarginContainer/menu_buttons_container/VBoxContainer/try_again_button" method="_on_mouse_exited"]
[connection signal="mouse_entered" from="defeat_ui/MarginContainer/VBoxContainer/MarginContainer/MarginContainer/menu_buttons_container/VBoxContainer/exit_button" to="defeat_ui/MarginContainer/VBoxContainer/MarginContainer/MarginContainer/menu_buttons_container/VBoxContainer/exit_button" method="_on_mouse_entered"]
[connection signal="mouse_exited" from="defeat_ui/MarginContainer/VBoxContainer/MarginContainer/MarginContainer/menu_buttons_container/VBoxContainer/exit_button" to="defeat_ui/MarginContainer/VBoxContainer/MarginContainer/MarginContainer/menu_buttons_container/VBoxContainer/exit_button" method="_on_mouse_exited"]
